<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic ¬∑ Criminos.jl</title><meta name="title" content="Basic ¬∑ Criminos.jl"/><meta property="og:title" content="Basic ¬∑ Criminos.jl"/><meta property="twitter:title" content="Basic ¬∑ Criminos.jl"/><meta name="description" content="Documentation for Criminos.jl."/><meta property="og:description" content="Documentation for Criminos.jl."/><meta property="twitter:description" content="Documentation for Criminos.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Criminos.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Basic</a><ul class="internal"><li><a class="tocitem" href="#Basics"><span>Basics</span></a></li><li><a class="tocitem" href="#Dynamics-of-x"><span>Dynamics of <span>$x$</span></span></a></li><li><a class="tocitem" href="#Adversarial-Energy,-and-Best-Response"><span>Adversarial Energy, and Best Response</span></a></li><li><a class="tocitem" href="#Extension-to-Multiple-Subpopulation"><span>Extension to Multiple Subpopulation</span></a></li></ul></li><li><a class="tocitem" href="../decision/">Dynamic œÑ</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../data/">Data Source</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basic</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bzhangcw/Criminos.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bzhangcw/Criminos.jl/blob/240411-inexact-bcd/docs/src/basic.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="The-Incentive-Deterrence-Model"><a class="docs-heading-anchor" href="#The-Incentive-Deterrence-Model">The Incentive-Deterrence Model</a><a id="The-Incentive-Deterrence-Model-1"></a><a class="docs-heading-anchor-permalink" href="#The-Incentive-Deterrence-Model" title="Permalink"></a></h1><h2 id="Basics"><a class="docs-heading-anchor" href="#Basics">Basics</a><a id="Basics-1"></a><a class="docs-heading-anchor-permalink" href="#Basics" title="Permalink"></a></h2><p>The dynamics of the system is,</p><p class="math-container">\[\left\{\begin{array}{ll}
    y_{t+1}    &amp; = \varphi_{t+1}(x_t, y_t, \tau),         \\
    x_{t+1} &amp; = \Gamma x_k - \hat\Gamma y_{t+1} + \lambda_t.
\end{array}\right.\]</p><p>The main fixed-point iteration is at,</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Criminos.F!" href="#Criminos.F!"><code>Criminos.F!</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">F!(
    vector_ms::Vector{MarkovState{R,Tx}},
    vec_Œ®::Vector{BidiagSys{Tx,Tm}};
    f‚Çú=Criminos.decision_identity, targs=nothing, # function of decision
    f‚Çò=Criminos.mixed_in_identity, margs=nothing, # function of mixed-in effect
    kwargs...
) where {R,Tx,Tm}</code></pre><p>The <code>F!</code> function performs a fixed-point iteration on a vector of <code>MarkovState</code> objects and a vector of <code>BidiagSys</code> objects. It updates the states in <code>vector_ms</code> and <code>vec_Œ®</code> according to the specified functions <code>f‚Çú</code>, <code>f‚Çò</code>, and <code>F‚Çì</code>.</p><p><strong>Arguments</strong></p><ul><li><code>vector_ms::Vector{MarkovState{R,Tx}}</code>: A vector of <code>MarkovState</code> objects.</li><li><code>vec_Œ®::Vector{BidiagSys{Tx,Tm}}</code>: A vector of <code>BidiagSys</code> objects.</li><li><code>f‚Çú</code>: A function that updates the states in <code>vector_ms</code> collectively. Default is <code>Criminos.decision_identity</code>.</li><li><code>targs</code>: Additional arguments for the function <code>f‚Çú</code>. Default is <code>nothing</code>.</li><li><code>f‚Çò</code>: A function that updates the states in <code>vec_Œ®</code> collectively. Default is <code>Criminos.mixed_in_identity</code>.</li><li><code>margs</code>: Additional arguments for the function <code>f‚Çò</code>. Default is <code>nothing</code>.</li><li><code>kwargs...</code>: Additional keyword arguments.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bzhangcw/Criminos.jl/blob/dfa5755c253a1c73daf98a42b50af5337ffa0fc3/src/fixpoint.jl#L5-L25">source</a></section></article><p>We define two data structs:</p><ul><li>the system struct, <span>$\Psi$</span>, to store constants</li><li>the state variable, <span>$z$</span>, for <span>$(x,y)$</span> in the math, and attributes to enable efficient computations üòç </li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Criminos.BidiagSys" href="#Criminos.BidiagSys"><code>Criminos.BidiagSys</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>mutable struct BidiagSys{Tx,Tm}</p><p>Bidiagonal system in the paper.</p><p><strong>Fields</strong></p><ul><li><code>n::Int</code>: Number of states.</li><li><code>Œ≥::Tx</code>: Rate retention.</li><li><code>Œª::Tx</code>: Rate arrival.</li><li><code>q::Tx</code>: Probability.</li><li><code>M::Tm</code>: Helper matrix.</li><li><code>Q::Tm</code>: Helper matrix.</li><li><code>Œì::Tm</code>: Helper matrix.</li><li><code>Œì‚Çï::Tm</code>: Helper matrix.</li><li><code>style::Symbol</code>: Random or known.</li></ul><p><strong>Constructors</strong></p><ul><li><code>BidiagSys(n::Int; style=:rand)</code>: Constructs a <code>BidiagSys</code> object with the specified number of states <code>n</code> and style <code>style</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bzhangcw/Criminos.jl/blob/dfa5755c253a1c73daf98a42b50af5337ffa0fc3/src/bidiag.jl#L5-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Criminos.MarkovState" href="#Criminos.MarkovState"><code>Criminos.MarkovState</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>struct MarkovState{R,Tx}</p><p>A mutable struct representing the state of a Markov-type Dynamical system</p><p><strong>Fields</strong></p><ul><li><code>k::Int</code>: The iteration number.</li><li><code>n::Int</code>: The number of states.</li><li><code>z::Tx</code>: The fix-point iterate.</li><li><code>x::Tx</code>: The iterate.</li><li><code>x‚Çã::Tx</code>: The previous iterate.</li><li><code>œÅ::Tx</code>: The probability.</li><li><code>y::Tx</code>: The recidivists.</li><li><code>y‚Çã::Tx</code>: The previous recidivists.</li><li><code>œÑ::Tx</code>: The treatment probability.</li><li><code>f::Real</code>: The objective value of the mixed-in function.</li></ul><p><strong>Constructors</strong></p><ul><li><code>MarkovState(k, n::Int; z=[Random.rand(Float64, n); Random.rand(Float64, n)], œÑ=Random.rand(Float64, n), Œ≤::Real=1.0)</code>: Constructs a <code>MarkovState</code> object with the given parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bzhangcw/Criminos.jl/blob/dfa5755c253a1c73daf98a42b50af5337ffa0fc3/src/state.jl#L10-L30">source</a></section></article><h2 id="Dynamics-of-x"><a class="docs-heading-anchor" href="#Dynamics-of-x">Dynamics of <span>$x$</span></a><a id="Dynamics-of-x-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamics-of-x" title="Permalink"></a></h2><p>The <span>$x$</span> part is simple,</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Criminos.F‚Çì" href="#Criminos.F‚Çì"><code>Criminos.F‚Çì</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><p>population dynamics <code>x</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bzhangcw/Criminos.jl/blob/dfa5755c253a1c73daf98a42b50af5337ffa0fc3/src/fixpoint.jl#L43-L45">source</a></section></article><p class="math-container">\[x_{t+1} = \Gamma x_t - \hat\Gamma y_t + \lambda_t.\]</p><p>In this view, we use <span>$\Psi$</span></p><p class="math-container">\[\quad \Gamma =\mathrm{diag}(\gamma), \quad \hat \Gamma =
\begin{bmatrix}
    \gamma_0  &amp; 0        &amp; \cdots        &amp; 0            \\
    -\gamma_0 &amp; \gamma_1 &amp; \cdots        &amp; 0            \\
    \vdots    &amp; \ddots   &amp; \ddots        &amp; \vdots       \\
    0         &amp; \cdots   &amp; -\gamma_{N-2} &amp; \gamma_{N-1},
\end{bmatrix}.\]</p><p>such that we call the <code>bi-diagonal system</code>.  The associated &quot;potential&quot; or Lynapunov function is,</p><p class="math-container">\[u(x, y) = \frac{1}{2}(x)^T(I - \Gamma)x - (\lambda)^T x + (x)^T \hat{\Gamma} y\]</p><h2 id="Adversarial-Energy,-and-Best-Response"><a class="docs-heading-anchor" href="#Adversarial-Energy,-and-Best-Response">Adversarial Energy, and Best Response</a><a id="Adversarial-Energy,-and-Best-Response-1"></a><a class="docs-heading-anchor-permalink" href="#Adversarial-Energy,-and-Best-Response" title="Permalink"></a></h2><p>Note <span>$\varphi$</span> of <span>$y$</span> follows the utility/potential/energy <span>$\omega$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Criminos.w" href="#Criminos.w"><code>Criminos.w</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">linear quadratic function</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bzhangcw/Criminos.jl/blob/dfa5755c253a1c73daf98a42b50af5337ffa0fc3/src/mixin_gnep.jl#L26-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Criminos.mixed_in_gnep_best!" href="#Criminos.mixed_in_gnep_best!"><code>Criminos.mixed_in_gnep_best!</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">best response for the GNEP problem 
```math
y \in [0, x_{k+1}]
```</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bzhangcw/Criminos.jl/blob/dfa5755c253a1c73daf98a42b50af5337ffa0fc3/src/mixin_gnep.jl#L51-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Criminos.mixed_in_gnep_grad!" href="#Criminos.mixed_in_gnep_grad!"><code>Criminos.mixed_in_gnep_grad!</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">&quot;better&quot; response for the GNEP problem 
```math
y \in [0, x_{k+1}]
```</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bzhangcw/Criminos.jl/blob/dfa5755c253a1c73daf98a42b50af5337ffa0fc3/src/mixin_gnep.jl#L145-L150">source</a></section></article><p>we take arguments </p><pre><code class="nohighlight hljs">‚àá‚ÇÄ, H‚ÇÄ, ‚àá‚Çú, H‚Çú, _... = args</code></pre><p>for any <span>$y,\tau$</span>, compute <span>$c$</span> from the exogenous arrivals</p><p class="math-container">\[c = Q\lambda\]</p><blockquote><p>the deterrence &amp; incentives</p></blockquote><p class="math-container">\[\begin{aligned}
\nabla^2\omega &amp;= \operatorname{diag}(\tau) \cdot H_t \cdot \operatorname{diag}(\tau) + H_0 \\
\nabla\omega &amp;= (\nabla^2\omega) y + \underbrace{\nabla_t \tau - \nabla_0 c}_{g} + \hat \Gamma^Tx
\end{aligned}\]</p><p>and finally</p><p class="math-container">\[\omega(y,\tau) = \frac{1}{2}y^T (\nabla^2\omega) y + y^T \left(\nabla_t \tau - \nabla_0 c\right) + y^T\hat \Gamma^Tx\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>One can see <span>$\tau$</span> is crucial to compute the second-order derivatives. If <span>$\tau = 0$</span>, this reduce to <span>$H_0, \nabla_0 c$</span>... This can be taken as <code>intrinsic</code> property of a subpopulation</p></div></div><h2 id="Extension-to-Multiple-Subpopulation"><a class="docs-heading-anchor" href="#Extension-to-Multiple-Subpopulation">Extension to Multiple Subpopulation</a><a id="Extension-to-Multiple-Subpopulation-1"></a><a class="docs-heading-anchor-permalink" href="#Extension-to-Multiple-Subpopulation" title="Permalink"></a></h2><p>For multiple population, <span>$\nu = 0,..., M-1$</span>, now <span>$\omega$</span> has multiple blocks, <span>$y^0, \ldots, y^\nu, \ldots, y^{M-1}$</span>, stick to the parameterization,</p><p class="math-container">\[g^\nu = \nabla^\nu_t \tau^\nu - \nabla^\nu_0 c^\nu\]</p><p>Then the energy can we rewritten as,</p><p class="math-container">\[\begin{aligned}
    \omega(y, x, \tau) := 
    y^T \begin{bmatrix}
            (\hat{\Gamma}^0)^T x^0 \\
            \vdots \\
            (\hat{\Gamma}^{M-1})^T x^{M-1} \\
        \end{bmatrix} +
    y^T \begin{bmatrix}
        g^0 \\
        \vdots \\
        g^{M-1} \\
    \end{bmatrix} +

    \frac{1}{2} y^T \begin{bmatrix}
                       H^1       &amp; \cdots &amp; H^{1,M-1} \\
                       \vdots    &amp; \ddots &amp; \vdots    \\
                       H^{M-1,1} &amp; \cdots &amp; H^{M-1}   \\
                     \end{bmatrix} y
\end{aligned}\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If <span>$H_t^{i,j} \neq 0$</span>, then the recidivism of <span>$i$</span> is affected by the recidivism of <span>$j$</span>.</p></div></div><p>Population is still independent,</p><p class="math-container">\[\forall \nu, \quad u^\nu(x^\nu, y_k^\nu) = \frac{1}{2}(x^\nu)^T(I - \Gamma^\nu)x^\nu - (\lambda^\nu)^T x^\nu + (x^\nu)^T \hat{\Gamma}^\nu y_k^\nu\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">¬´ Home</a><a class="docs-footer-nextpage" href="../decision/">Dynamic œÑ ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Monday 10 June 2024 15:42">Monday 10 June 2024</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
